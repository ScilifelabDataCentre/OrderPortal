{# Search page. #}

{% extends "base.html" %}

{% block head_title %}Search orders{% end %}
{% block body_title %}{% end %}

{% block search_field %}{% end %}

{% block container %}
<div class="container-fluid">
{% end %}

{% block content %}
<form action="{{ reverse_url('search') }}"
      role="form"
      class="form-inline"
      method="GET">
  <div class="row">
    <div class="col-md-6 col-md-offset-2">
      <div class="form-group">
        <div class="input-group">
          <div class="input-group-addon">Search orders</div>
	  <input type="text" name="term" id="term" size="40"
	         class="form-control input-lg" placeholder="Search"
	         value="{{ term or '' }}">
	  <div class="input-group-btn">
	    <button class="btn btn-default input-lg" type="submit">
	      <span class="glyphicon glyphicon-search"></span>
	    </button>
	  </div>
        </div>
        <p class="help-block">Searches title, identifier, tags and any indexed fields.</p>
      </div>
    </div>
  </div>
</form>

<div class="row">
  <div class="col-md-12">
    <table id="orders" class="table table-striped table-condensed">
      <thead>
	<tr>
	  <th>Order</th>
	  <th>Title</th>
	  <th>Owner</th>
	  <th>Status</th>
	  <th>Modified</th>
	</tr>
      </thead>
      <tbody>
	{% for item in orders %}
	<tr>
	  <td>{% module Entity(item) %}</td>
	  <td>
	    {% if item['orderportal_doctype'] == constants.ACCOUNT %}
	    {{ get_account_name(account=item) }}
	    {% else %}
	    {{ item.get('title') or '-' }}
	    {% end %}
	  </td>
	  <td class="nobr">
	    {% if item['orderportal_doctype'] != constants.ACCOUNT %}
	    <a href="{{ reverse_url('account', item['owner']) }}">
	      {{ account_names.get(item['owner'], item['owner']) }}
	    </a>
	    {% end %}
	  </td>
	  <td>
	    {% if 'status' in item %}
	    {% module Icon(item['status'], label=True) %}
	    {% end %}
	  </td>
	  <td class="localtime nobr">{{ item['modified'] }}</td>
	</tr>
	{% end %} {# for item in orders #}
      </tbody>
    </table>
  </div>
</div>
{% end %} {# block content #}

{% block javascript_code %}
<script>
$(function() {
  $("#orders").DataTable( {
    "pagingType": "full_numbers",
    "pageLength": 25,
    "searching": false,
    "order": [[4, "desc"]],
  });
});
</script>
{% end %} {# block javascript_code #}
