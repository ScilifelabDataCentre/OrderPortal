{# Home page when not logged in; base for other home page variants. #}

{% extends "base.html" %}

{% block head_title %}{{ settings['FACILITY_NAME'] }} Order Portal{% end %}
{% block body_title %}
<img src="{{ static_url(settings['FACILITY_ICON_HOME']) }}"
     title="{{ settings['FACILITY_NAME'] }}"
     alt="{{ settings['FACILITY_NAME'] }}">
{{ settings['FACILITY_NAME'] }} Order Portal
{% end %}

{% block content %}

{% block content-header %}
<div class="row">
  <div class="col-sm-10 col-sm-offset-1">
    <div class="panel panel-default">
      <div class="panel-body">
	{% if is_admin %}
	<form action="{{ reverse_url('text', 'header') }}"
	      role="form" class="pull-right" method="GET">
	  <input type="hidden" name="origin"
		 value="{{ absolute_reverse_url('home') }}">
	  <button type="submit"
		  class="btn btn-sm btn-default glyphicon glyphicon-edit">
	    Edit
	  </button>
	</form>
	{% end %}
	<div>
	  {% module Text('header') %}
	</div>
      </div>
    </div>
  </div>
  <div class="col-sm-11">
  </div>
</div>
{% end %} {# block content-header #}

<div class="row">

  {% block content-left %}
  <div class="col-sm-5">
    <div class="panel panel-warning">
      <div class="panel-heading">
	<span class="glyphicon glyphicon-user">
	  User account login
	</span>
      </div>
      <div class="panel-body">

	<form action="{{ reverse_url('login') }}" method="POST" role="form">
	  {% module xsrf_form_html() %}
	  <div class="form-group">
	    <label for="email">Email</label>
	    <input type="text" class="form-control" name="email"
		   placeholder="Email address of existing account">
	  </div>
	  <div class="form-group">
	    <label for="password">Password</label>
	    <input type="password" class="form-control" name="password">
	  </div>
	  <div class="form-group"> 
	    <button type="submit"
		    class="btn btn-warning glyphicon glyphicon-log-in">
	      Login
	    </button>
	  </div>
	</form>
	  
	<br>
	<p>
	  <a href="{{ reverse_url('register') }}"
	     class="btn btn-default glyphicon glyphicon-user" role="button">
	    Register new user account
	  </a>
	</p>
	<p>
	  <a href="{{ reverse_url('reset') }}"
	     class="btn btn-default glyphicon glyphicon-envelope" role="button">
	    Reset your password
	  </a>
	</p>
      </div>
    </div>

  </div>
  {% end %} {# block content-left #}

  {% block content-right %}
  <div class="col-sm-7">

    <div class="panel panel-primary">
      <div class="panel-heading">
	<span class="glyphicon glyphicon-info-sign">
	  News
	</span>
	{% if is_admin %}
	<form action="{{ reverse_url('news') }}"
	      role="form" class="pull-right" method="GET">
	  <button type="submit"
		  class="btn btn-xs btn-default glyphicon glyphicon-edit">
	    Edit
	  </button>
	</form>
	{% end %}
      </div>
      <div class="panel-body">
	{% if news %}
	<table class="table table-condensed">
	  {% for new in news %}
	  <tr>
	    <td>
	      {% module Markdown(new) %}
	    </td>
	    <td class="text-right small">
	      [{{ new['modified'].split('T')[0] }}]
	    </td>
	  </tr>
	  {% end %}
	</table>
	{% else %}
	<i>Currently none. Check again later.</i>
	{% end %}
      </div>
    </div>

    <div class="panel panel-success">
      <div class="panel-heading">
	<a href="{{ reverse_url('events') }}"
	   class="btn btn-success glyphicon glyphicon-calendar">
	  Events
	</a>
	{% if is_admin %}
	<form action="{{ reverse_url('events') }}"
	      role="form" class="pull-right" method="GET">
	  <button type="submit"
		  class="btn btn-default glyphicon glyphicon-edit">
	    Edit
	  </button>
	</form>
	{% end %}
      </div>
      <div class="panel-body">
	{% if news %}
	<ul class="list-group">
	  {% for event in events %}
	  <li class="list-group-item">{{ repr(event) }} </li>
	  {% end %}
	</ul>
	{% else %}
	<i>Currently none. Check again later.</i>
	{% end %}
      </div>
    </div>
  </div>
  {% end %} {# block content-right #}

</div>

{% block content-footer %}
<div class="row">
  <div class="col-sm-10 col-sm-offset-1">
    <div class="panel panel-info">
      <div class="panel-body">
	{% if is_admin %}
	<form action="{{ reverse_url('text', 'footer') }}"
	      role="form" class="pull-right" method="GET">
	  <input type="hidden" name="origin"
		 value="{{ absolute_reverse_url('home') }}">
	  <button type="submit"
		  class="btn btn-sm btn-default glyphicon glyphicon-edit">
	    Edit
	  </button>
	</form>
	{% end %}
	<div>
	  {% module Text('footer') %}
	</div>
      </div>
    </div>
  </div>
</div>
{% end %} {# block content-footer #}

{% end %} {# block content #}
